
<p>Function <b>basicAjax()</b> gets data with AJAX in a thread, sorts it and returns the first 5 elements of the array.
We run this function in 2 different threads providing different URLs, and then join responses from these 2 threads. </p>

<pre><code data-language="javascript">
  function basicAjax(url) {

    var httpRequest = new XMLHttpRequest(),
        result;

    httpRequest.onreadystatechange = function(){
      if (httpRequest.readyState === 4) {
        if (httpRequest.status === 200) {
          result = JSON.parse(httpRequest.responseText);
        } else {
          result = 'There was a problem with the request.';
        }
      }
    };

    // IMPORTANT: ajax must perform the operation synchronously
    // (the 3-rd arg is false); as ajax is executed in a thread, it's OK.
    httpRequest.open('GET', url, false);
    httpRequest.send();

    function compare(a,b){
      return b.stargazers_count - a.stargazers_count
    }

    return result.sort(compare).slice(0,5);
  }
</code></pre>

<p><input type="button" ng-click="runMultiThread()" value="Run in two different threads" /> </p>

<pre><code data-language="javascript">
var param1 = {
          fn: basicAjax,
          args: ['https://api.github.com/users/angular/repos']
      };
var param2 = {
          fn: basicAjax,
          args: ['https://api.github.com/users/vkiryukhin/repos']
      }

  vkThread.execAll([param1,param2]).then(
      function (data) {
        $scope.repos = data[0].concat(data[1]);
      },
      function(err) {
        alert(err);
      }
  );
</code></pre>

